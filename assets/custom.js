/* START OF "Size Guide Data" */
var data = {
  bottom: {
    regions: ['AU', 'US', 'EU', 'UK'],
    names: {
      AU: 'Australia / New Zealand',
      US: 'USA / Latam',
      EU: 'Europe / Japan',
      UK: 'United Kingdom'
    },
    sizes: {
      AU: [6, 8, 10, 12, 14, 16],
      US: [2, 4, 6, 8, 10, 12],
      EU: [34, 36, 38, 40, 42, 44],
      UK: [6, 8, 10, 12, 14, 16]
    },
    results: {
      AU6: {
        size: 'XS',
        measurements: [
          'Waist: 65 - 69 cm',
          'High hip: 85 - 88 cm'
        ]
      }, 
      AU8: {
        size: 'S',
        measurements: [
          'Waist: 70 - 73 cm',
          'High hip: 89 - 91 cm'
        ]
      }, 
      AU10: {
        size: 'M',
        measurements: [
          'Waist: 74 - 78 cm',
          'High hip: 92 - 94cm'
        ]
      }, 
      AU12: {
        size: 'L',
        measurements: [
          'Waist: 79 - 83 cm',
          'High hip: 95 - 97cm'
        ]
      }, 
      AU14: {
        size: 'XL',
        measurements: [
          'Waist: 84 - 88 cm',
          'High hip: 98 - 101 cm'
        ]
      }, 
      AU16: {
        size: 'XXL',
        measurements: [
          'Waist: 89 - 93 cm',
          'High hip: 102 - 105 cm'
        ]
      },
      US2: {
        size: 'XS',
        measurements: [
          'Waist: 65 - 69 cm',
          'High hip: 85 - 88 cm'
        ]
      }, 
      US4: {
        size: 'S',
        measurements: [
          'Waist: 70 - 73 cm',
          'High hip: 89 - 91 cm'
        ]
      }, 
      US6: {
        size: 'M',
        measurements: [
          'Waist: 74 - 78 cm',
          'High hip: 92 - 94cm'
        ]
      }, 
      US8: {
        size: 'L',
        measurements: [
          'Waist: 79 - 83 cm',
          'High hip: 95 - 97cm'
        ]
      }, 
      US10: {
        size: 'XL',
        measurements: [
          'Waist: 84 - 88 cm',
          'High hip: 98 - 101 cm'
        ]
      }, 
      US12: {
        size: 'XXL',
        measurements: [
          'Waist: 89 - 93 cm',
          'High hip: 102 - 105 cm'
        ]
      },
      EU34: {
        size: 'XS',
        measurements: [
          'Waist: 65 - 69 cm',
          'High hip: 85 - 88 cm'
        ]
      }, 
      EU36: {
        size: 'S',
        measurements: [
          'Waist: 70 - 73 cm',
          'High hip: 89 - 91 cm'
        ]
      }, 
      EU38: {
        size: 'M',
        measurements: [
          'Waist: 74 - 78 cm',
          'High hip: 92 - 94cm'
        ]
      }, 
      EU40: {
        size: 'L',
        measurements: [
          'Waist: 79 - 83 cm',
          'High hip: 95 - 97cm'
        ]
      }, 
      EU42: {
        size: 'XL',
        measurements: [
          'Waist: 84 - 88 cm',
          'High hip: 98 - 101 cm'
        ]
      }, 
      EU4: {
        size: 'XXL',
        measurements: [
          'Waist: 89 - 93 cm',
          'High hip: 102 - 105 cm'
        ]
      },
      UK6: {
        size: 'XS',
        measurements: [
          'Waist: 65 - 69 cm',
          'High hip: 85 - 88 cm'
        ]
      }, 
      UK8: {
        size: 'S',
        measurements: [
          'Waist: 70 - 73 cm',
          'High hip: 89 - 91 cm'
        ]
      }, 
      UK10: {
        size: 'M',
        measurements: [
          'Waist: 74 - 78 cm',
          'High hip: 92 - 94cm'
        ]
      }, 
      UK12: {
        size: 'L',
        measurements: [
          'Waist: 79 - 83 cm',
          'High hip: 95 - 97cm'
        ]
      }, 
      UK14: {
        size: 'XL',
        measurements: [
          'Waist: 84 - 88 cm',
          'High hip: 98 - 101 cm'
        ]
      }, 
      UK16: {
        size: 'XXL',
        measurements: [
          'Waist: 89 - 93 cm',
          'High hip: 102 - 105 cm'
        ]
      }
    }
  },
  top: {
    regions: ['AU', 'US', 'EU', 'UK', 'SP', 'IT'],
    names: {
      AU: 'Australia / New Zealand',
      US: 'USA / Latam',
      EU: 'Europe / Japan',
      UK: 'United Kingdom',
      SP: 'Spain / France / Belgium',
      IT: 'Italy / Czech Republic'
    },
    sizes: {
      AU: [8, 10, 12, 14, 16],
      US: [30, 32, 34, 36, 38],
      EU: [65, 70, 75, 80, 85],
      UK: [30, 32, 34, 36, 38],
      SP: [80, 85, 90, 95, 100],
      IT: [0, 1, 2, 3, 4]
    },
    cups: {
      AU8: ['AA', 'A'],
      AU10: ['AA', 'A', 'B', 'C', 'D', 'DD'],
      AU12: ['A', 'B', 'C', 'D'],
      AU14: ['A', 'B', 'C', 'D'],
      AU16: ['AA', 'A', 'B', 'C'],
      US30: ['AA', 'A'],
      US32: ['AA', 'A', 'B', 'C', 'D', 'DD', 'DDD/E'],
      US34: ['A', 'B', 'C', 'D', 'DD'],
      US36: ['A', 'B', 'C', 'D', 'DD'],
      US38: ['A', 'B', 'C', 'D'],
      EU65: ['A', 'B'],
      EU70: ['A', 'B', 'C', 'D', 'E', 'F'],
      EU75: ['A', 'B', 'C', 'D', 'E'],
      EU80: ['A', 'B', 'C', 'D', 'E'],
      EU85: ['A', 'B', 'C', 'D'],
      UK30: ['A', 'B'],
      UK32: ['A', 'B', 'C', 'D', 'DD', 'E'],
      UK34: ['A', 'B', 'C', 'D', 'DD'],
      UK36: ['A', 'B', 'C', 'D', 'DD'],
      UK38: ['A', 'B', 'C', 'D'],
      SP80: ['A', 'B'],
      SP85: ['A', 'B', 'C', 'D', 'E', 'F'],
      SP90: ['A', 'B', 'C', 'D', 'E'],
      SP95: ['A', 'B', 'C', 'D', 'E'],
      SP100: ['A', 'B', 'C', 'D'],
      IT0: ['A', 'B'],
      IT1: ['A', 'B', 'C', 'D', 'E', 'F'],
      IT2: ['A', 'B', 'C', 'D', 'E'],
      IT3: ['A', 'B', 'C', 'D', 'E'],
      IT4: ['A', 'B', 'C', 'D']
    },
    results: {
      AU8AA: { 
        size: 'XS',
        measurements: []
      },
      AU8A: { 
        size: 'XS',
        measurements: []
      },
      AU10AA: { 
        size: 'XS',
        measurements: []
      },
      AU10A: { 
        size: 'XS/S',
        measurements: []
      },
      AU10B: { 
        size: 'M',
        measurements: []
      },
      AU10C: { 
        size: 'M/L',
        measurements: []
      },
      AU10D: { 
        size: 'L',
        measurements: []
      },
      AU10DD: { 
        size: 'XL',
        measurements: []
      },
      AU12A: { 
        size: 'XS/S',
        measurements: []
      },
      AU12B: { 
        size: 'M',
        measurements: []
      },
      AU12C: { 
        size: 'L',
        measurements: []
      },
      AU12D: { 
        size: 'XL',
        measurements: []
      },
      AU14A: { 
        size: 'S/M',
        measurements: []
      },
      AU14B: { 
        size: 'L',
        measurements: []
      },
      AU14C: { 
        size: 'XL',
        measurements: []
      },
      AU14D: { 
        size: 'XXL',
        measurements: []
      },
      AU16AA: { 
        size: 'M',
        measurements: []
      },
      AU16A: { 
        size: 'L',
        measurements: []
      },
      AU16B: { 
        size: 'XL',
        measurements: []
      },
      AU16C: { 
        size: 'XXL',
        measurements: []
      },
      US30AA: { 
        size: 'XS',
        measurements: []
      },
      US30A: { 
        size: 'XS',
        measurements: []
      },
      US32AA: { 
        size: 'XS',
        measurements: []
      },
      US32A: { 
        size: 'XS',
        measurements: []
      },
      US32B: { 
        size: 'S',
        measurements: []
      },
      US32C: { 
        size: 'M',
        measurements: []
      },
      US32D: { 
        size: 'M/L',
        measurements: []
      },
      US32DD: { 
        size: 'L',
        measurements: []
      },
      US32DDDE: { 
        size: 'XL',
        measurements: []
      },
      US34A: { 
        size: 'XS',
        measurements: []
      },
      US34B: { 
        size: 'S',
        measurements: []
      },
      US34C: { 
        size: 'M',
        measurements: []
      },
      US34D: { 
        size: 'L',
        measurements: []
      },
      US34DD: { 
        size: 'XL',
        measurements: []
      },
      US36A: { 
        size: 'S',
        measurements: []
      },
      US36B: { 
        size: 'M',
        measurements: []
      },
      US36C: { 
        size: 'L',
        measurements: []
      },
      US36D: { 
        size: 'XL',
        measurements: []
      },
      US36DD: { 
        size: 'XXL',
        measurements: []
      },
      US38A: { 
        size: 'M',
        measurements: []
      },
      US38B: { 
        size: 'L',
        measurements: []
      },
      US38C: { 
        size: 'XL',
        measurements: []
      },
      US38D: { 
        size: 'XXL',
        measurements: []
      },
      UK30A: { 
        size: 'XS',
        measurements: []
      },
      UK30B: { 
        size: 'XS',
        measurements: []
      },
      UK32A: { 
        size: 'XS',
        measurements: []
      },
      UK32B: { 
        size: 'S',
        measurements: []
      },
      UK32C: { 
        size: 'M',
        measurements: []
      },
      UK32D: { 
        size: 'M/L',
        measurements: []
      },
      UK32DD: { 
        size: 'L',
        measurements: []
      },
      UK32E: { 
        size: 'XL',
        measurements: []
      },
      UK34A: { 
        size: 'XS',
        measurements: []
      },
      UK34B: { 
        size: 'S',
        measurements: []
      },
      UK34C: { 
        size: 'M',
        measurements: []
      },
      UK34D: { 
        size: 'L',
        measurements: []
      },
      UK34DD: { 
        size: 'XL',
        measurements: []
      },
      UK36A: { 
        size: 'S',
        measurements: []
      },
      UK36B: { 
        size: 'M',
        measurements: []
      },
      UK36C: { 
        size: 'L',
        measurements: []
      },
      UK36D: { 
        size: 'XL',
        measurements: []
      },
      UK36DD: { 
        size: 'XXL',
        measurements: []
      },
      UK38A: { 
        size: 'M',
        measurements: []
      },
      UK38B: { 
        size: 'L',
        measurements: []
      },
      UK38C: { 
        size: 'XL',
        measurements: []
      },
      UK38D: { 
        size: 'XXL',
        measurements: []
      },
      EU65A: { 
        size: 'XS',
        measurements: []
      },
      EU65B: { 
        size: 'XS',
        measurements: []
      },
      EU70A: { 
        size: 'XS',
        measurements: []
      },
      EU70B: { 
        size: 'S',
        measurements: []
      },
      EU70C: { 
        size: 'M',
        measurements: []
      },
      EU70D: { 
        size: 'M/L',
        measurements: []
      },
      EU70E: { 
        size: 'L',
        measurements: []
      },
      EU70F: { 
        size: 'XL',
        measurements: []
      },
      EU75A: { 
        size: 'XS',
        measurements: []
      },
      EU75B: { 
        size: 'S',
        measurements: []
      },
      EU75C: { 
        size: 'M',
        measurements: []
      },
      EU75D: { 
        size: 'L',
        measurements: []
      },
      EU75E: { 
        size: 'XL',
        measurements: []
      },
      EU80A: { 
        size: 'S',
        measurements: []
      },
      EU80B: { 
        size: 'M',
        measurements: []
      },
      EU80C: { 
        size: 'L',
        measurements: []
      },
      EU80D: { 
        size: 'XL',
        measurements: []
      },
      EU80E: { 
        size: 'XXL',
        measurements: []
      },
      EU85A: { 
        size: 'M',
        measurements: []
      },
      EU85B: { 
        size: 'L',
        measurements: []
      },
      EU85C: { 
        size: 'XL',
        measurements: []
      },
      EU85D: { 
        size: 'XXL',
        measurements: []
      },
      SP80A: { 
        size: 'XS',
        measurements: []
      },
      SP80B: { 
        size: 'XS',
        measurements: []
      },
      SP85A: { 
        size: 'XS',
        measurements: []
      },
      SP85B: { 
        size: 'S',
        measurements: []
      },
      SP85C: { 
        size: 'M',
        measurements: []
      },
      SP85D: { 
        size: 'M/L',
        measurements: []
      },
      SP85E: { 
        size: 'L',
        measurements: []
      },
      SP85F: { 
        size: 'XL',
        measurements: []
      },
      SP90A: { 
        size: 'XS',
        measurements: []
      },
      SP90B: { 
        size: 'S',
        measurements: []
      },
      SP90C: { 
        size: 'M',
        measurements: []
      },
      SP90D: { 
        size: 'L',
        measurements: []
      },
      SP90E: { 
        size: 'XL',
        measurements: []
      },
      SP95A: { 
        size: 'S',
        measurements: []
      },
      SP95B: { 
        size: 'M',
        measurements: []
      },
      SP95C: { 
        size: 'L',
        measurements: []
      },
      SP95D: { 
        size: 'XL',
        measurements: []
      },
      SP95E: { 
        size: 'XXL',
        measurements: []
      },
      SP100A: { 
        size: 'M',
        measurements: []
      },
      SP100B: { 
        size: 'L',
        measurements: []
      },
      SP100C: { 
        size: 'XL',
        measurements: []
      },
      SP100D: { 
        size: 'XXL',
        measurements: []
      },
      IT0A: { 
        size: 'XS',
        measurements: []
      },
      IT0B: { 
        size: 'XS',
        measurements: []
      },
      IT1A: { 
        size: 'XS',
        measurements: []
      },
      IT1B: { 
        size: 'S',
        measurements: []
      },
      IT1C: { 
        size: 'M',
        measurements: []
      },
      IT1D: { 
        size: 'M/L',
        measurements: []
      },
      IT1E: { 
        size: 'L',
        measurements: []
      },
      IT1F: { 
        size: 'XL',
        measurements: []
      },
      IT2A: { 
        size: 'XS',
        measurements: []
      },
      IT2B: { 
        size: 'S',
        measurements: []
      },
      IT2C: { 
        size: 'M',
        measurements: []
      },
      IT2D: { 
        size: 'L',
        measurements: []
      },
      IT2E: { 
        size: 'XL',
        measurements: []
      },
      IT3A: { 
        size: 'S',
        measurements: []
      },
      IT3B: { 
        size: 'M',
        measurements: []
      },
      IT3C: { 
        size: 'L',
        measurements: []
      },
      IT3D: { 
        size: 'XL',
        measurements: []
      },
      IT3E: { 
        size: 'XXL',
        measurements: []
      },
      IT4A: { 
        size: 'M',
        measurements: []
      },
      IT4B: { 
        size: 'L',
        measurements: []
      },
      IT4C: { 
        size: 'XL',
        measurements: []
      },
      IT4D: { 
        size: 'XXL',
        measurements: []
      }
    }
  }
};
/* END OF "Size GuideData" */

/* START OF "Init Function" */
(function(){
  /* START OF "Custom jQuery Events" */
  const originalAddClassMethod = jQuery.fn.addClass;
  const originalRemoveClassMethod = jQuery.fn.removeClass;
  const originalTextChangeMethod = jQuery.fn.text;

  jQuery.fn.addClass = function() {
    const result = originalAddClassMethod.apply( this, arguments );
    jQuery(this).trigger('cssClassChanged');
    return result;
  };
  jQuery.fn.removeClass = function() {
    const result = originalRemoveClassMethod.apply( this, arguments );
    jQuery(this).trigger('cssClassChanged');
    return result;
  };
  jQuery.fn.text = function() {
    const result = originalTextChangeMethod.apply( this, arguments );
    jQuery(this).trigger('textChanged');
    return result;
  };
  /* END OF "Custom jQuery Events" */

  /* START OF "Custom Onload Events" */
  jQuery(window).on('load', function() {
    /* START OF "Banner Resize" */
    jQuery('.custom-resize').each(function () {
      var target = jQuery(this).find('.promobox--clean').find('.rimage');
      var value = target.prop('style')['padding-top'].replace('%', '');
  
      target.attr('data-percentage', value);
    });

    bannerResize();
  
    jQuery(window).on('resize', bannerResize);
    /* END OF "Banner Resize" */

    /* START OF "Collection Filters" */
    filterAvailable();
    /* END OF "Collection Filters" */

    /* START OF "Remove mobile menu items" */
    jQuery('.menu__level-01').children().each(function() {
      var item = jQuery(this);
      var itemText = item.contents('a').contents('span').text();
      switch(itemText.toUpperCase()) {
        case 'ALL SWIMWEAR':
          item.addClass('d-lg-none');
          break;
      }
      
    });
    jQuery('.menu__level-03').find('.col-lg').find('.menu__list--styled').children().each(function() {
      var item = jQuery(this);
      var itemText = item.contents('a').contents('span').text();
      switch(itemText.toUpperCase()) {
        case 'ALL SWIMWEAR':
          item.addClass('d-none d-lg-block');
          break;
      }
    });
    /* END OF "Remove mobile menu items" */

    /* START OF "Remove Pre Selected Variants" */
    var button = jQuery('[data-button-status="select"]')[0];
    if(button) jQuery('[data-label-value]').html('');

    jQuery('[data-label-value]').on('textChanged', function(e) {
      jQuery('[data-disable-auto-select]').each(function(e) {
        jQuery(this).prev().find('[data-label-value]').html('');
      });
    });
    /* END OF "Remove Pre Selected Variants" */

    /* START OF "Toggle Pre Order Text Function" */
    jQuery('.label--pre-order').on('cssClassChanged', function(e){
      var validation = jQuery(this).hasClass('d-none-important');
      var element = jQuery('[data-custom-pre-date]');
      if(validation) element.addClass('d-none-important');
      else element.removeClass('d-none-important');
    });
    /* END OF "Toggle Pre Order Text Function" */

    /* START OF "Size Guide" */
    var main = jQuery('#main-selector');
    var firstOption = main.find('button').first();

    main.children().each(function() {
      var element = jQuery(this);
      element.on('click', function(e) {
        refresh(element);
      });
    });

    refresh(firstOption);
    /* END OF "Size Guide" */
  });
  /* END OF "Custom Onload Events" */
})();
/* END OF "Init Function" */

/* START OF "Availability Autoselect Functions" */
function filterAvailable() {
  var input = jQuery('#Filter-Availability-1');
  if(!input.is(":checked")) input.click();
}
/* END OF "Availability Autoselect Functions" */

/* START OF "Banner Resize Functions" */
function bannerResize() {
  var validation = jQuery(window).width() >= 768;
  
  jQuery('.custom-resize').each(function () {
    var container = jQuery(this);
    var source = container.find('.custom-resize-source');
    var target = container.find('.promobox--clean').find('.rimage');
    var heightToUse = source.height();
    var widthToUse = source.width();
    var originalPercentage = parseFloat(target.attr('data-percentage'));
    var percentageToUse = (heightToUse * 100) / widthToUse;
    percentageToUse = percentageToUse > originalPercentage
      ? percentageToUse
      : originalPercentage;

    if(validation) target.css('padding-top', percentageToUse + '%');
    else target.css('padding-top', originalPercentage + '%');
  });
};
/* END OF "Banner Resize Functions" */

/* START OF "Size Guide Functions" */
function refresh(element) {
  var value = element.data('value');
  var cups = jQuery('#cups');
  var cupsContainer = cups.parent();

  jQuery('.fit-option-fade-active').removeClass('fit-option-fade-active');
  element.addClass('fit-option-fade-active');

  switch(value){
    case 'top':
      cupsContainer.removeClass('fit-hide');
      var selectedRegion = fill(value, 'regions');
      var selectedSizes = fill(value, 'sizes', selectedRegion);
      fill(value, 'cups', selectedRegion + selectedSizes);
      result(value);
      break;
    case 'bottom':  
      cups.empty();
      cupsContainer.addClass('fit-hide');
      var selectedRegion = fill(value, 'regions');
      fill(value, 'sizes', selectedRegion);
      result(value);
      break;
  }
};

function fill(model, selector, prevValue) {
  var defaultValue;
  var elements = (prevValue)
    ? data[model][selector][prevValue]
    : data[model][selector];
  var container = jQuery('#' + selector);
 
  container.empty();

  for(var i = 0; i < elements.length; i++) {
    var options = {
      class: 'fit-option fit-option-line fit-option-label',
      text: elements[i],
      on: {
        click: function(e) {
          e.preventDefault();
          option(this, model, container);
        }
      }
    };

    if(i == 0) {
      options.class = options.class + ' fit-option-line-active fit-option-bold';
      defaultValue = elements[i];
    } 

    container.append(jQuery('<button/>', options));
  }

  if(selector == 'regions'){
    var nameToUse = data[model].names[defaultValue];
    jQuery('#names').text(nameToUse);
  }

  return defaultValue;
};

function result(model) {
  var resultContainer = jQuery('#fit-result');
  var measurementContainer = jQuery('#fit-measurement');
  var customized = jQuery('#customized');
  var currentRegion = jQuery('#regions').find('.fit-option-line-active').text();
  var currentSize = jQuery('#sizes').find('.fit-option-line-active').text();
  var currentCup = jQuery('#cups').find('.fit-option-line-active').text();
  var attrToUse = model == 'top'
    ? currentRegion + currentSize + currentCup
    : currentRegion + currentSize;

  attrToUse = attrToUse.replace(/[^0-9a-zA-Z]+/, '');
  var resultToUse = data[model].results[attrToUse];
  var size = resultToUse.size;
  var measurements = resultToUse.measurements
  
  resultContainer.text(size);
  measurementContainer.empty();
  
  if(size == 'XXL') {
    customized.removeClass('fit-hide');
  }
  else {
    customized.addClass('fit-hide');
  }

  if(measurements.length > 0){
    measurementContainer.removeClass('fit-hide');

    for(var i = 0; i < measurements.length; i++) {
      var measurement = {
        class: 'fit-result-label',
        text: measurements[i]
      };

      measurementContainer.append(jQuery('<span></span>', measurement));
    }
  }
  else measurementContainer.addClass('fit-hide');
};

function option(element, model, container){
  element = jQuery(element);

  var valueToUse = element.text();
  var nameToUse = data[model].names[valueToUse];

  container.find('.fit-option-line-active').removeClass('fit-option-line-active fit-option-bold');
  element.addClass('fit-option-line-active fit-option-bold');

  switch(container.attr('id')) {
    case 'regions':
      jQuery('#names').text(nameToUse);
      var currentSize = fill(model, 'sizes', valueToUse);
      if(model == 'top') fill(model, 'cups', valueToUse + currentSize);
      result(model);
      break;
    case 'sizes':
      if(model == 'top'){
        var currentRegion = jQuery('#regions').find('.fit-option-line-active').text();
        fill(model, 'cups', currentRegion + valueToUse);
        result(model);
      }
      else result(model);
      break;
    case 'cups':
      result(model);
      break;
  }
};
/* END OF "Size Guide Functions" */